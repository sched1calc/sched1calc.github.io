var I=Object.defineProperty;var R=(i,l,v)=>l in i?I(i,l,{enumerable:!0,configurable:!0,writable:!0,value:v}):i[l]=v;var w=(i,l,v)=>R(i,typeof l!="symbol"?l+"":l,v);(function(){"use strict";var i=(n=>(n[n.AntiGravity=0]="AntiGravity",n[n.Athletic=1]="Athletic",n[n.Balding=2]="Balding",n[n.BrightEyed=3]="BrightEyed",n[n.Calming=4]="Calming",n[n.CalorieDense=5]="CalorieDense",n[n.Cyclopean=6]="Cyclopean",n[n.Disorienting=7]="Disorienting",n[n.Electrifying=8]="Electrifying",n[n.Energizing=9]="Energizing",n[n.Euphoric=10]="Euphoric",n[n.Explosive=11]="Explosive",n[n.Focused=12]="Focused",n[n.Foggy=13]="Foggy",n[n.Gingeritis=14]="Gingeritis",n[n.Glowing=15]="Glowing",n[n.Jennerising=16]="Jennerising",n[n.Laxative=17]="Laxative",n[n.LongFaced=18]="LongFaced",n[n.Munchies=19]="Munchies",n[n.Paranoia=20]="Paranoia",n[n.Refreshing=21]="Refreshing",n[n.Schizophrenia=22]="Schizophrenia",n[n.Sedating=23]="Sedating",n[n.SeizureInducing=24]="SeizureInducing",n[n.Shrinking=25]="Shrinking",n[n.Slippery=26]="Slippery",n[n.Smelly=27]="Smelly",n[n.Sneaky=28]="Sneaky",n[n.Spicy=29]="Spicy",n[n.ThoughtProvoking=30]="ThoughtProvoking",n[n.Toxic=31]="Toxic",n[n.TropicThunder=32]="TropicThunder",n[n.Zombifying=33]="Zombifying",n))(i||{});const l=Object.keys(i).filter(n=>isNaN(+n)),v=[{name:"OG Kush",initial:[i.Calming],price:35},{name:"Sour Diesel",initial:[i.Refreshing],price:35},{name:"Green Crack",initial:[i.Energizing],price:35},{name:"Grandaddy Purple",initial:[i.Sedating],price:35},{name:"Meth",initial:[],price:70},{name:"Coke",initial:[],price:150}],M=[{name:"Addy",effect:i.ThoughtProvoking,conditions:[{if:i.Explosive,then:i.Euphoric},{if:i.Foggy,then:i.Energizing},{if:i.Glowing,then:i.Refreshing},{if:i.LongFaced,then:i.Electrifying},{if:i.Sedating,then:i.Gingeritis}],cost:7},{name:"Banana",effect:i.Gingeritis,conditions:[{if:i.Calming,then:i.Sneaky},{if:i.Cyclopean,then:i.Energizing},{if:i.Disorienting,then:i.Focused},{if:i.Energizing,then:i.ThoughtProvoking},{if:i.Focused,then:i.SeizureInducing},{if:i.LongFaced,then:i.Refreshing},{if:i.Paranoia,then:i.Jennerising},{if:i.Smelly,then:i.AntiGravity},{if:i.Toxic,then:i.Smelly}],cost:2},{name:"Battery",effect:i.BrightEyed,conditions:[{if:i.Cyclopean,then:i.Glowing},{if:i.Electrifying,then:i.Euphoric},{if:i.Euphoric,then:i.Zombifying},{if:i.Laxative,then:i.CalorieDense},{if:i.Munchies,then:i.TropicThunder},{if:i.Shrinking,then:i.Munchies}],cost:8},{name:"Chili",effect:i.Spicy,conditions:[{if:i.AntiGravity,then:i.TropicThunder},{if:i.Athletic,then:i.Euphoric},{if:i.Laxative,then:i.LongFaced},{if:i.Munchies,then:i.Toxic},{if:i.Shrinking,then:i.Refreshing},{if:i.Sneaky,then:i.BrightEyed}],cost:7},{name:"Cuke",effect:i.Energizing,conditions:[{if:i.Euphoric,then:i.Laxative},{if:i.Foggy,then:i.Cyclopean},{if:i.Gingeritis,then:i.ThoughtProvoking},{if:i.Munchies,then:i.Athletic},{if:i.Slippery,then:i.Munchies},{if:i.Slippery,then:i.Athletic},{if:i.Sneaky,then:i.Paranoia},{if:i.Toxic,then:i.Euphoric}],cost:2},{name:"Donut",effect:i.CalorieDense,conditions:[{if:i.AntiGravity,then:i.Slippery},{if:i.Balding,then:i.Sneaky},{if:i.CalorieDense,then:i.Explosive},{if:i.Focused,then:i.Euphoric},{if:i.Jennerising,then:i.Gingeritis},{if:i.Munchies,then:i.Calming},{if:i.Shrinking,then:i.Energizing}],cost:3},{name:"Energy Drink",effect:i.Athletic,conditions:[{if:i.Disorienting,then:i.Electrifying},{if:i.Euphoric,then:i.Energizing},{if:i.Focused,then:i.Shrinking},{if:i.Foggy,then:i.Laxative},{if:i.Glowing,then:i.Disorienting},{if:i.Schizophrenia,then:i.Balding},{if:i.Sedating,then:i.Munchies},{if:i.Spicy,then:i.Euphoric},{if:i.TropicThunder,then:i.Sneaky}],cost:6},{name:"Flu Medicine",effect:i.Sedating,conditions:[{if:i.Athletic,then:i.Munchies},{if:i.Calming,then:i.BrightEyed},{if:i.Cyclopean,then:i.Foggy},{if:i.Electrifying,then:i.Refreshing},{if:i.Euphoric,then:i.Toxic},{if:i.Focused,then:i.Calming},{if:i.Laxative,then:i.Euphoric},{if:i.Munchies,then:i.Slippery},{if:i.Shrinking,then:i.Paranoia},{if:i.ThoughtProvoking,then:i.Gingeritis}],cost:5},{name:"Gasoline",effect:i.Toxic,conditions:[{if:i.Disorienting,then:i.Glowing},{if:i.Electrifying,then:i.Disorienting},{if:i.Energizing,then:i.Euphoric},{if:i.Euphoric,then:i.Spicy},{if:i.Gingeritis,then:i.Smelly},{if:i.Jennerising,then:i.Sneaky},{if:i.Laxative,then:i.Foggy},{if:i.Munchies,then:i.Sedating},{if:i.Paranoia,then:i.Calming},{if:i.Shrinking,then:i.Focused},{if:i.Sneaky,then:i.TropicThunder}],cost:5},{name:"Horse Semen",effect:i.LongFaced,conditions:[{if:i.AntiGravity,then:i.Calming},{if:i.Gingeritis,then:i.Refreshing},{if:i.SeizureInducing,then:i.Energizing},{if:i.ThoughtProvoking,then:i.Electrifying}],cost:9},{name:"Iodine",effect:i.Jennerising,conditions:[{if:i.Calming,then:i.Balding},{if:i.CalorieDense,then:i.Gingeritis},{if:i.Euphoric,then:i.SeizureInducing},{if:i.Foggy,then:i.Paranoia},{if:i.Refreshing,then:i.ThoughtProvoking},{if:i.Toxic,then:i.Sneaky}],cost:8},{name:"Mega Bean",effect:i.Foggy,conditions:[{if:i.Athletic,then:i.Laxative},{if:i.Calming,then:i.Glowing},{if:i.Energizing,then:i.Cyclopean},{if:i.Focused,then:i.Disorienting},{if:i.Jennerising,then:i.Paranoia},{if:i.SeizureInducing,then:i.Focused},{if:i.Shrinking,then:i.Electrifying},{if:i.Slippery,then:i.Toxic},{if:i.Sneaky,then:i.Calming},{if:i.ThoughtProvoking,then:i.Energizing}],cost:7},{name:"Motor Oil",effect:i.Slippery,conditions:[{if:i.Energizing,then:i.Munchies},{if:i.Euphoric,then:i.Sedating},{if:i.Foggy,then:i.Toxic},{if:i.Munchies,then:i.Schizophrenia},{if:i.Paranoia,then:i.AntiGravity},{if:i.Energizing,then:i.Schizophrenia}],cost:6},{name:"Mouth Wash",effect:i.Balding,conditions:[{if:i.Calming,then:i.AntiGravity},{if:i.CalorieDense,then:i.Sneaky},{if:i.Explosive,then:i.Sedating},{if:i.Focused,then:i.Jennerising}],cost:4},{name:"Paracetamol",effect:i.Sneaky,conditions:[{if:i.Calming,then:i.Slippery},{if:i.Electrifying,then:i.Athletic},{if:i.Energizing,then:i.Paranoia},{if:i.Focused,then:i.Gingeritis},{if:i.Foggy,then:i.Calming},{if:i.Glowing,then:i.Toxic},{if:i.Munchies,then:i.AntiGravity},{if:i.Paranoia,then:i.Balding},{if:i.Spicy,then:i.BrightEyed},{if:i.Toxic,then:i.TropicThunder}],cost:3},{name:"Viagra",effect:i.TropicThunder,conditions:[{if:i.Athletic,then:i.Sneaky},{if:i.Disorienting,then:i.Toxic},{if:i.Euphoric,then:i.BrightEyed},{if:i.Laxative,then:i.Calming},{if:i.Shrinking,then:i.Gingeritis}],cost:4}],z={};l.forEach((n,e)=>{z[i[n]]=1n<<BigInt(e)});const x=M.map(n=>({name:n.name,mainMask:1n<<BigInt(n.effect),condMasks:n.conditions.map(e=>[1n<<BigInt(e.if),1n<<BigInt(e.then)]),cost:n.cost}));[...x].map((n,e)=>({value:e.toString(),label:n.name})),M.reduce((n,e,t)=>(n[e.name]=t,n),{});function B(n){let e=0;for(;n;)n&=n-1n,e++;return e}function A(n,e){let t=n;for(const[o,r]of e.condMasks)(t&o)!==0n&&(t&r)===0n&&(t=t&~o|r);return(t&e.mainMask)===0n&&B(t)<8&&(t|=e.mainMask),t}v.map(n=>{const e=n.initial.reduce((t,o)=>t|1n<<BigInt(o),0n);return{name:n.name,mask:e,baseValue:n.price}});class b{constructor(e){w(this,"data",[]);this.cmp=e}push(e){this.data.push(e);let t=this.data.length-1;for(;t>0;){const o=t-1>>1;if(this.cmp(this.data[t],this.data[o])>=0)break;[this.data[t],this.data[o]]=[this.data[o],this.data[t]],t=o}}pop(){if(!this.data.length)return;const e=this.data[0],t=this.data.pop();if(this.data.length){this.data[0]=t;let o=0;for(;;){let r=2*o+1;if(r>=this.data.length||(r+1<this.data.length&&this.cmp(this.data[r+1],this.data[r])<0&&r++,this.cmp(this.data[r],this.data[o])>=0))break;[this.data[o],this.data[r]]=[this.data[r],this.data[o]],o=r}}return e}peek(){return this.data[0]}get size(){return this.data.length}}function D(n,e){const t=new Map,o=[e];for(t.set(e,{prev:e,ingr:-1});o.length;){const r=o.shift();for(let h=0;h<x.length;h++){const s=A(r,x[h]);if(!(s===r||t.has(s))){if(t.set(s,{prev:r,ingr:h}),(s&n)===n){const C=[];let d=s;for(;;){const m=t.get(d);if(m.ingr<0)break;C.push(m.ingr),d=m.prev}return C.reverse()}o.push(s)}}}return null}async function P(n,e,t,o,r){if(t.aborted)throw new DOMException("aborted","AbortError");if(console.debug("[A*] start",{target:n,baseMask:e}),(e&n)===n)return console.debug("[A*] zero‑step match"),[];const h=o.length;if(r.length!==h||r.some(a=>a.length!==h))throw new Error(`pairDist must be ${h}×${h}`);const s=x.length,C=a=>{const f=n&~a;let S=0;for(let u=0;u<h;u++)if(f>>BigInt(u)&1n){S=Math.max(S,o[u]);for(let k=u+1;k<h;k++)f>>BigInt(k)&1n&&(S=Math.max(S,r[u][k]))}return S},d=new b((a,f)=>a.f-f.f),m=new Map,G=new Map;d.push({mask:e,g:0,f:C(e)}),m.set(e,{prev:e,ingr:-1}),G.set(e,0);let F=0;const L=5e3;for(;d.size;){if(t.aborted)throw new DOMException("aborted","AbortError");const{mask:a,g:f}=d.pop();if(f>(G.get(a)??1/0))continue;if(++F%L===0&&console.debug(`[A*] expansions=${F} open=${d.size} g=${f}`),(a&n)===n){const g=[];let c=a;for(;;){const y=m.get(c);if(y.ingr<0)break;g.push(y.ingr),c=y.prev}g.reverse();let p=e;for(const y of g)p=A(p,x[y]);if((p&n)===n)return console.debug(`[A*] found path after ${F} expansions`,g),g;console.warn(`[A*] spurious inclusion at exp=${F}`,{rawMask:a,replayMask:p})}const S=n&~a,u=[],k=[];for(let g=0;g<s;g++){const c=A(a,x[g]);c!==a&&((c&S)!==0n?u.push([g,c]):k.push([g,c]))}for(const[g,c]of u.concat(k)){const p=f+1,y=G.get(c);y!==void 0&&p>=y||(G.set(c,p),m.set(c,{prev:a,ingr:g}),d.push({mask:c,g:p,f:p+C(c)}))}}console.error(`[A*] exhausted open list after ${F} expansions—returning null`),console.debug("[A*] running BFS fallback to check reachability…");try{const a=D(n,e);console.debug("[BFS] fallback result:",a)}catch(a){console.error("[BFS] fallback threw error:",a)}return null}let T;self.addEventListener("message",async n=>{const e=n.data;if(e.type==="cancel"){T==null||T.abort();return}if(e.type==="start"){const{targetMask:t,baseMask:o,singleDist:r,pairDist:h}=e;T=new AbortController;try{const s=await P(t,o,T.signal,r,h);self.postMessage({type:"result",path:s??[]})}catch(s){s.name==="AbortError"?self.postMessage({type:"cancelled"}):self.postMessage({type:"error",message:s.message})}}})})();
