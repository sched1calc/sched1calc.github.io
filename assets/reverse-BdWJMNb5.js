import{g as Pe,$ as oe,s as K,B as F,A as se,z as Re,a0 as H,a1 as we,j as Q,l as X,t as te,a2 as me,U as Ie,y as re,a3 as Be,a4 as xe,H as J,a5 as Me,a6 as Ne,u as Te,X as G,a7 as Ee,a8 as Ve,N as O,a9 as Ae,Z as ee,Y as q,aa as We,ab as $e,ac as fe,O as pe,K as U,ad as ze,P as Ge,S as Fe,Q as De,R as Y,J as Oe,T as he,ae as be,af as qe,W as Le,_ as Ue,w as He}from"./mixResult-BCZqVEGs.js";import{b as f,q as s}from"./index-BEAhMyTn.js";function ae({color:e,theme:o,autoContrast:t}){return(typeof t=="boolean"?t:o.autoContrast)&&oe({color:e||o.primaryColor,theme:o}).isLight?"var(--mantine-color-black)":"var(--mantine-color-white)"}function po(e,o){return ae({color:e.colors[e.primaryColor][Pe(e,o)],theme:e,autoContrast:null})}function Ce(e,o){return typeof e=="boolean"?e:o.autoContrast}var ye={root:"m_5f75b09e",body:"m_5f6e695e",labelWrapper:"m_d3ea56bb",label:"m_8ee546b8",description:"m_328f68c0",error:"m_8e8a99cc"};const Je=ye,ke=f.forwardRef(({__staticSelector:e,__stylesApiProps:o,className:t,classNames:u,styles:b,unstyled:p,children:i,label:l,description:C,id:I,disabled:m,error:M,size:y,labelPosition:S="left",bodyElement:x="div",labelElement:g="label",variant:E,style:V,vars:j,mod:N,...P},R)=>{const k=K({name:e,props:o,className:t,style:V,classes:ye,classNames:u,styles:b,unstyled:p});return s.jsx(F,{...k("root"),ref:R,__vars:{"--label-fz":Re(y),"--label-lh":se(y,"label-lh")},mod:[{"label-position":S},N],variant:E,size:y,...P,children:s.jsxs(F,{component:x,htmlFor:x==="label"?I:void 0,...k("body"),children:[i,s.jsxs("div",{...k("labelWrapper"),"data-disabled":m||void 0,children:[l&&s.jsx(F,{component:g,htmlFor:g==="label"?I:void 0,...k("label"),"data-disabled":m||void 0,children:l}),C&&s.jsx(H.Description,{size:y,__inheritStyles:!1,...k("description"),children:C}),M&&typeof M!="boolean"&&s.jsx(H.Error,{size:y,__inheritStyles:!1,...k("error"),children:M})]})]})})});ke.displayName="@mantine/core/InlineInput";const ge=f.createContext(null),Ke=ge.Provider,ve=()=>f.useContext(ge),[Qe,Xe]=we();var _e={card:"m_26775b0a"};const Ye={withBorder:!0},Ze=te((e,{radius:o})=>({card:{"--card-radius":re(o)}})),ne=Q((e,o)=>{const t=X("CheckboxCard",Ye,e),{classNames:u,className:b,style:p,styles:i,unstyled:l,vars:C,checked:I,mod:m,withBorder:M,value:y,onClick:S,defaultChecked:x,onChange:g,...E}=t,V=K({name:"CheckboxCard",classes:_e,props:t,className:b,style:p,classNames:u,styles:i,unstyled:l,vars:C,varsResolver:Ze,rootSelector:"card"}),j=ve(),N=typeof I=="boolean"?I:j?j.value.includes(y||""):void 0,[P,R]=me({value:N,defaultValue:x,finalValue:!1,onChange:g});return s.jsx(Qe,{value:{checked:P},children:s.jsx(Ie,{ref:o,mod:[{"with-border":M,checked:P},m],...V("card"),...E,role:"checkbox","aria-checked":P,onClick:k=>{S==null||S(k),j==null||j.onChange(y||""),R(!P)}})})});ne.displayName="@mantine/core/CheckboxCard";ne.classes=_e;function eo({children:e,role:o}){const t=Be();return t?s.jsx("div",{role:o,"aria-labelledby":t.labelId,"aria-describedby":t.describedBy,children:e}):s.jsx(s.Fragment,{children:e})}const oo={},le=Q((e,o)=>{const{value:t,defaultValue:u,onChange:b,size:p,wrapperProps:i,children:l,readOnly:C,...I}=X("CheckboxGroup",oo,e),[m,M]=me({value:t,defaultValue:u,finalValue:[],onChange:b}),y=S=>{const x=typeof S=="string"?S:S.currentTarget.value;!C&&M(m.includes(x)?m.filter(g=>g!==x):[...m,x])};return s.jsx(Ke,{value:{value:m,onChange:y,size:p},children:s.jsx(H.Wrapper,{size:p,ref:o,...i,...I,labelElement:"div",__staticSelector:"CheckboxGroup",children:s.jsx(eo,{role:"group",children:l})})})});le.classes=H.Wrapper.classes;le.displayName="@mantine/core/CheckboxGroup";var Se={indicator:"m_5e5256ee",icon:"m_1b1c543a","indicator--outline":"m_76e20374"};const so={icon:xe},to=te((e,{radius:o,color:t,size:u,iconColor:b,variant:p,autoContrast:i})=>{const l=oe({color:t||e.primaryColor,theme:e}),C=l.isThemeColor&&l.shade===void 0?`var(--mantine-color-${l.color}-outline)`:l.color;return{indicator:{"--checkbox-size":se(u,"checkbox-size"),"--checkbox-radius":o===void 0?void 0:re(o),"--checkbox-color":p==="outline"?C:J(t,e),"--checkbox-icon-color":b?J(b,e):Ce(i,e)?ae({color:t,theme:e,autoContrast:i}):void 0}}}),ce=Q((e,o)=>{const t=X("CheckboxIndicator",so,e),{classNames:u,className:b,style:p,styles:i,unstyled:l,vars:C,icon:I,indeterminate:m,radius:M,color:y,iconColor:S,autoContrast:x,checked:g,mod:E,variant:V,disabled:j,...N}=t,P=I,R=K({name:"CheckboxIndicator",classes:Se,props:t,className:b,style:p,classNames:u,styles:i,unstyled:l,vars:C,varsResolver:to,rootSelector:"indicator"}),k=Xe(),$=typeof g=="boolean"||typeof m=="boolean"?g||m:(k==null?void 0:k.checked)||!1;return s.jsx(F,{ref:o,...R("indicator",{variant:V}),variant:V,mod:[{checked:$,disabled:j},E],...N,children:s.jsx(P,{indeterminate:m,...R("icon")})})});ce.displayName="@mantine/core/CheckboxIndicator";ce.classes=Se;var je={root:"m_bf2d988c",inner:"m_26062bec",input:"m_26063560",icon:"m_bf295423","input--outline":"m_215c4542"};const ro={labelPosition:"right",icon:xe},ao=te((e,{radius:o,color:t,size:u,iconColor:b,variant:p,autoContrast:i})=>{const l=oe({color:t||e.primaryColor,theme:e}),C=l.isThemeColor&&l.shade===void 0?`var(--mantine-color-${l.color}-outline)`:l.color;return{root:{"--checkbox-size":se(u,"checkbox-size"),"--checkbox-radius":o===void 0?void 0:re(o),"--checkbox-color":p==="outline"?C:J(t,e),"--checkbox-icon-color":b?J(b,e):Ce(i,e)?ae({color:t,theme:e,autoContrast:i}):void 0}}}),L=Q((e,o)=>{const t=X("Checkbox",ro,e),{classNames:u,className:b,style:p,styles:i,unstyled:l,vars:C,color:I,label:m,id:M,size:y,radius:S,wrapperProps:x,checked:g,labelPosition:E,description:V,error:j,disabled:N,variant:P,indeterminate:R,icon:k,rootRef:$,iconColor:ie,onChange:D,autoContrast:ue,mod:r,...a}=t,c=ve(),A=y||(c==null?void 0:c.size),v=k,_=K({name:"Checkbox",props:t,classes:je,className:b,style:p,classNames:u,styles:i,unstyled:l,vars:C,varsResolver:ao}),{styleProps:T,rest:n}=Me(a),d=Ne(M),B=c?{checked:c.value.includes(n.value),onChange:h=>{c.onChange(h),D==null||D(h)}}:{},W=f.useRef(null),z=o||W;return f.useEffect(()=>{z&&"current"in z&&z.current&&(z.current.indeterminate=R||!1)},[R,z]),s.jsx(ke,{..._("root"),__staticSelector:"Checkbox",__stylesApiProps:t,id:d,size:A,labelPosition:E,label:m,description:V,error:j,disabled:N,classNames:u,styles:i,unstyled:l,"data-checked":B.checked||g||void 0,variant:P,ref:$,mod:r,...T,...x,children:s.jsxs(F,{..._("inner"),mod:{"data-label-position":E},children:[s.jsx(F,{component:"input",id:d,ref:z,checked:g,disabled:N,mod:{error:!!j,indeterminate:R},..._("input",{focusable:!0,variant:P}),onChange:D,...n,...B,type:"checkbox"}),s.jsx(v,{indeterminate:R,..._("icon")})]})})});L.classes={...je,...Je};L.displayName="@mantine/core/Checkbox";L.Group=le;L.Indicator=ce;L.Card=ne;function no(e){return new Worker("/assets/worker-W4oPCuRP.js",{name:e==null?void 0:e.name})}const Z=e=>G.filter((o,t)=>(e&q[ee[o]])!==0n),lo=()=>{const e=Te(),[o,t]=f.useState(0),[u,b]=f.useState(Array(G.length).fill(!1)),[p,i]=f.useState(!1),[l,C]=f.useState(null),[I,m]=f.useState(null),[M,y]=f.useState(null),S=f.useRef(null),x=f.useRef(null),g=f.useMemo(()=>Ee(),[]),[E,V]=f.useState(0),[j,N]=f.useState(),P=f.useMemo(()=>o>=0?Ve(O[o].mask):[],[o]),R=f.useCallback((r,a,c,A,v)=>{var T;(T=x.current)==null||T.terminate();const _=new no;x.current=_,_.onmessage=n=>{i(!1);const d=n.data;if(d.type==="result"&&Array.isArray(d.path)){const B=[...v,...d.path],W=Ae(O[o].mask,r,B);console.log(`[Prune] raw=${B.length}, pruned=${W.length}`),$(W)}else d.type==="error"&&console.error("Search error:",d.message)},_.onerror=n=>{i(!1),N(n.message)},console.log("[Worker] targetMask →",Z(r),"searchMask →",Z(r)),_.postMessage({type:"start",targetMask:r,baseMask:a,singleDist:c,pairDist:A})},[]),k=f.useCallback(()=>{var T;if(o<0)return;(T=S.current)==null||T.abort();const r=u.map((n,d)=>n?ee[G[d]]:-1).filter(n=>n>=0),a=r.reduce((n,d)=>n|q[d],0n);console.log("[Search] Selected effects →",r.map(n=>G[n]),`
 fullMask bits →`,Z(a));let c=O[o].mask;if((c&a)===a){$([]);return}const A=We(a,c);if(A){$(A),setTimeout(async()=>{try{const n=await $e(a,c);n&&n.length<A.length&&$(n)}catch{}},0);return}const v=[],_=r.filter(n=>g[n].length===1);for(const n of _){const d=q[n],B=fe(d,c);if(B)for(const W of B)c=pe(c,U[W]),v.push(W)}C(null),m(null),y(null),N(null),i(!0),(async()=>{const n=r.filter(h=>!_.includes(h)),d=n.length,B=Array.from({length:d},()=>Array(d).fill(1/0));for(let h=0;h<d;h++)for(let w=h+1;w<d;w++)B[h][w]=await ze(c,de=>(de&q[n[h]])!==0n&&(de&q[n[w]])!==0n),B[w][h]=B[h][w];const W=G.length,z=Array.from({length:W},()=>Array(W).fill(1/0));for(let h=0;h<d;h++)for(let w=0;w<d;w++)z[n[h]][n[w]]=B[h][w];R(a,c,P,z,v),r.length>=7&&setTimeout(()=>{var w;const h=fe(a,c);if(h===null){(w=x.current)==null||w.terminate(),i(!1),N("Combination cannot be achieved.");return}$(h)},1)})()},[o,u,P,g,R]),$=f.useCallback(r=>{C(r.map(v=>U[v].name)),V(r.reduce((v,_,T)=>v+U[_].cost,0));let a=O[o].mask;for(const v of r)a=pe(a,U[v]);const c=[];let A=0;G.forEach((v,_)=>{const T=ee[v];(a&q[T])!==0n&&(c.push(v),A+=Ue[T])}),m(c),y(O[o].baseValue*(1+A))},[o]),ie=f.useCallback(()=>{var r,a,c;(r=S.current)==null||r.abort(),(a=x.current)==null||a.postMessage({type:"cancel"}),(c=x.current)==null||c.terminate(),x.current=null,i(!1)},[]),D=r=>{const a=[...u];a[r]=!a[r],a.filter(Boolean).length<=8&&b(a)},ue=()=>{confirm("Are you sure you want to reset?")&&(t(0),m(null),y(null),b(r=>Array(r.length).fill(!1)))};return s.jsx(Ge,{size:"sm",py:"md",children:s.jsxs(Fe,{gap:"md",children:[s.jsxs(De,{order:3,fw:"bold",children:["Reverse Mix Finder",s.jsx(Y,{variant:"outline",style:{float:"right"},onClick:ue,children:"Reset"})]}),s.jsx(Oe,{label:"Base",placeholder:"Select base",data:O.map((r,a)=>({value:a.toString(),label:r.name})),value:o>=0?o.toString():null,onChange:(r,a)=>{t(+a.value)},clearable:!0}),o>=0&&s.jsxs(s.Fragment,{children:[s.jsx(he,{children:"Select up to 8 properties"}),s.jsx(F,{style:{columnCount:4,columnGap:"1rem"},children:[...G].map((r,a)=>s.jsx(L,{label:qe(r),checked:u[a],onChange:()=>D(a),color:be(r),style:{display:"block",whiteSpace:"nowrap",marginBottom:".5rem",color:be(r)}},r))})]}),s.jsx(Y,{onClick:k,disabled:o<0||p,loading:p,children:"Find Mix"}),s.jsxs("div",{children:[u.filter(Boolean).length>=4&&s.jsx("span",{children:"Warning: Complex searches can take a long time!"}),j&&s.jsx(he,{style:{color:e.colors.red[8]},children:j}),p&&s.jsx(Y,{variant:"outline",onClick:ie,disabled:!p,ml:"sm",style:{float:"right"},children:"Cancel"})]}),l&&I&&!p&&s.jsx(Le,{cost:E,resultProps:I,seqNames:l,totalValue:M})]})})},co={navLabel:"Reverse Calculator",navPath:"/reverse"},io=He(function({loaderData:o}){return s.jsx(lo,{})}),ho=Object.freeze(Object.defineProperty({__proto__:null,default:io,handle:co},Symbol.toStringTag,{value:"Module"}));export{ho as _,po as g,co as h,io as r};
